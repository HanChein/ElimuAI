<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AI-powered e-learning platform for Tanzania with Swahili/English support">
    <meta name="theme-color" content="#4a90d9">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ElimuAI">
    <title>ElimuAI - Personalized Learning Platform</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png">
</head>
<body>
    <!-- Toast Container for Notifications -->
    <div id="toastContainer" class="toast-container"></div>
    
    <div id="app">
        <nav class="navbar" id="navbar">
            <div class="nav-container">
                <div class="nav-brand" onclick="showPage('home')">
                    <span class="logo">ğŸ“ ElimuAI</span>
                </div>
                
                <div class="nav-menu" id="navMenu">
                    <a href="#" class="nav-link" onclick="showPage('home')">
                        <span class="nav-text-en">ğŸ  Home</span>
                        <span class="nav-text-sw" style="display:none;">ğŸ  Nyumbani</span>
                    </a>
                    <a href="#" class="nav-link" onclick="showPage('courses')" id="coursesLink" style="display:none;">
                        <span class="nav-text-en">ğŸ“š Courses</span>
                        <span class="nav-text-sw" style="display:none;">ğŸ“š Kozi</span>
                    </a>
                    <a href="#" class="nav-link" onclick="showPage('dashboard')" id="dashboardLink" style="display:none;">
                        <span class="nav-text-en">ğŸ“Š Dashboard</span>
                        <span class="nav-text-sw" style="display:none;">ğŸ“Š Dashibodi</span>
                    </a>
                    <a href="#" class="nav-link" onclick="showPage('chatbot')" id="chatbotLink" style="display:none;">
                        <span class="nav-text-en">ğŸ¤– AI Tutor</span>
                        <span class="nav-text-sw" style="display:none;">ğŸ¤– Mwalimu AI</span>
                    </a>
                    <a href="#" class="nav-link" onclick="showPage('gamification')" id="gamificationLink" style="display:none;">
                        <span class="nav-text-en">ğŸ† Rewards</span>
                        <span class="nav-text-sw" style="display:none;">ğŸ† Tuzo</span>
                    </a>
                    <a href="#" class="nav-link" onclick="showPage('certificates')" id="certificatesLink" style="display:none;">
                        <span class="nav-text-en">ğŸ“œ Certs</span>
                        <span class="nav-text-sw" style="display:none;">ğŸ“œ Vyeti</span>
                    </a>
                    <a href="#" class="nav-link" onclick="showPage('profile')" id="profileLink" style="display:none;">
                        <span class="nav-text-en">ğŸ‘¤ Profile</span>
                        <span class="nav-text-sw" style="display:none;">ğŸ‘¤ Wasifu</span>
                    </a>
                    
                    <div class="nav-auth" id="navAuth">
                        <button class="btn btn-outline" onclick="showPage('login')" id="loginBtn">
                            <span class="nav-text-en">Login</span>
                            <span class="nav-text-sw" style="display:none;">Ingia</span>
                        </button>
                        <button class="btn btn-primary" onclick="showPage('register')" id="registerBtn">
                            <span class="nav-text-en">Sign Up</span>
                            <span class="nav-text-sw" style="display:none;">Jisajili</span>
                        </button>
                        <button class="btn btn-outline" onclick="logout()" id="logoutBtn" style="display:none;">
                            <span class="nav-text-en">Logout</span>
                            <span class="nav-text-sw" style="display:none;">Toka</span>
                        </button>
                    </div>
                </div>
                
                <div class="nav-controls">
                    <button onclick="toggleTheme()" class="theme-toggle" id="themeToggle" title="Toggle dark mode">
                        <span id="themeIcon">ğŸŒ™</span>
                    </button>
                    <button onclick="toggleLanguage()" class="btn-lang" title="Switch language">
                        <span id="langToggleText">SW</span>
                    </button>
                    <button class="nav-toggle" id="navToggle" onclick="toggleNav()">
                        <div class="hamburger">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </button>
                </div>
            </div>
        </nav>

        <div id="homePage" class="page active">
            <section class="hero">
                <div class="hero-content">
                    <h1 class="hero-title">
                        <span class="text-en">Welcome to ElimuAI</span>
                        <span class="text-sw" style="display:none;">Karibu ElimuAI</span>
                    </h1>
                    <p class="hero-subtitle">
                        <span class="text-en">Personalized AI-powered learning for Math, Business & Vocational Skills</span>
                        <span class="text-sw" style="display:none;">Kujifunza kwa AI kwa Hesabu, Biashara na Ujuzi wa Ufundi</span>
                    </p>
                    <div class="hero-buttons">
                        <button class="btn btn-primary btn-lg" onclick="showPage('register')">
                            <span class="text-en">Get Started Free</span>
                            <span class="text-sw" style="display:none;">Anza Bure</span>
                        </button>
                        <button class="btn btn-outline btn-lg" onclick="showPage('courses')">
                            <span class="text-en">Browse Courses</span>
                            <span class="text-sw" style="display:none;">Tazama Kozi</span>
                        </button>
                    </div>
                </div>
            </section>

            <section class="features">
                <div class="container">
                    <h2 class="section-title">
                        <span class="text-en">Why Choose ElimuAI?</span>
                        <span class="text-sw" style="display:none;">Kwa Nini Chagua ElimuAI?</span>
                    </h2>
                    <div class="features-grid">
                        <div class="feature-card">
                            <div class="feature-icon">ğŸ¤–</div>
                            <h3>
                                <span class="text-en">AI-Powered Tutoring</span>
                                <span class="text-sw" style="display:none;">Mwalimu wa AI</span>
                            </h3>
                            <p>
                                <span class="text-en">Get instant help from our intelligent chatbot tutor in Swahili or English</span>
                                <span class="text-sw" style="display:none;">Pata msaada wa haraka kutoka kwa mwalimu wetu wa AI kwa Kiswahili au Kiingereza</span>
                            </p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">ğŸ“±</div>
                            <h3>
                                <span class="text-en">Mobile-First Design</span>
                                <span class="text-sw" style="display:none;">Muundo wa Simu</span>
                            </h3>
                            <p>
                                <span class="text-en">Learn anywhere, anytime on your Android device</span>
                                <span class="text-sw" style="display:none;">Jifunze popote, wakati wowote kwenye kifaa chako cha Android</span>
                            </p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">ğŸ¯</div>
                            <h3>
                                <span class="text-en">Adaptive Quizzes</span>
                                <span class="text-sw" style="display:none;">Majaribio ya Akili</span>
                            </h3>
                            <p>
                                <span class="text-en">Test your knowledge with quizzes that adapt to your level</span>
                                <span class="text-sw" style="display:none;">Jaribu maarifa yako na majaribio yanayobadilika kulingana na kiwango chako</span>
                            </p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">ğŸ’³</div>
                            <h3>
                                <span class="text-en">M-Pesa Integration</span>
                                <span class="text-sw" style="display:none;">Uunganisho wa M-Pesa</span>
                            </h3>
                            <p>
                                <span class="text-en">Easy payments for premium content via M-Pesa</span>
                                <span class="text-sw" style="display:none;">Malipo rahisi kwa maudhui ya premium kupitia M-Pesa</span>
                            </p>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <div id="registerPage" class="page">
            <div class="auth-container">
                <div class="auth-card">
                    <h2 class="auth-title">
                        <span class="text-en">Create Account</span>
                        <span class="text-sw" style="display:none;">Fungua Akaunti</span>
                    </h2>
                    <form id="registerForm" onsubmit="register(event)">
                        <div class="form-group">
                            <label>
                                <span class="text-en">Username</span>
                                <span class="text-sw" style="display:none;">Jina la Mtumiaji</span>
                            </label>
                            <input type="text" name="username" required class="form-input">
                        </div>
                        <div class="form-group">
                            <label>
                                <span class="text-en">Email</span>
                                <span class="text-sw" style="display:none;">Barua Pepe</span>
                            </label>
                            <input type="email" name="email" required class="form-input">
                        </div>
                        <div class="form-group">
                            <label>
                                <span class="text-en">Phone Number</span>
                                <span class="text-sw" style="display:none;">Nambari ya Simu</span>
                            </label>
                            <input type="tel" name="phone_number" placeholder="0712345678" class="form-input">
                        </div>
                        <div class="form-group">
                            <label>
                                <span class="text-en">Password</span>
                                <span class="text-sw" style="display:none;">Nywila</span>
                            </label>
                            <input type="password" name="password" required class="form-input">
                        </div>
                        <div class="form-group">
                            <label>
                                <span class="text-en">Preferred Language</span>
                                <span class="text-sw" style="display:none;">Lugha Unayopendelea</span>
                            </label>
                            <select name="preferred_language" class="form-input">
                                <option value="sw">Kiswahili</option>
                                <option value="en">English</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary btn-block">
                            <span class="text-en">Sign Up</span>
                            <span class="text-sw" style="display:none;">Jisajili</span>
                        </button>
                    </form>
                    <p class="auth-footer">
                        <span class="text-en">Already have an account?</span>
                        <span class="text-sw" style="display:none;">Tayari una akaunti?</span>
                        <a href="#" onclick="showPage('login')">
                            <span class="text-en">Login</span>
                            <span class="text-sw" style="display:none;">Ingia</span>
                        </a>
                    </p>
                </div>
            </div>
        </div>

        <div id="loginPage" class="page">
            <div class="auth-container">
                <div class="auth-card">
                    <h2 class="auth-title">
                        <span class="text-en">Login</span>
                        <span class="text-sw" style="display:none;">Ingia</span>
                    </h2>
                    <form id="loginForm" onsubmit="login(event)">
                        <div class="form-group">
                            <label>
                                <span class="text-en">Username</span>
                                <span class="text-sw" style="display:none;">Jina la Mtumiaji</span>
                            </label>
                            <input type="text" name="username" required class="form-input">
                        </div>
                        <div class="form-group">
                            <label>
                                <span class="text-en">Password</span>
                                <span class="text-sw" style="display:none;">Nywila</span>
                            </label>
                            <input type="password" name="password" required class="form-input">
                        </div>
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" name="remember">
                                <span class="text-en">Remember me</span>
                                <span class="text-sw" style="display:none;">Nikumbuke</span>
                            </label>
                        </div>
                        <button type="submit" class="btn btn-primary btn-block">
                            <span class="text-en">Login</span>
                            <span class="text-sw" style="display:none;">Ingia</span>
                        </button>
                    </form>
                    <p class="auth-footer">
                        <span class="text-en">Don't have an account?</span>
                        <span class="text-sw" style="display:none;">Huna akaunti?</span>
                        <a href="#" onclick="showPage('register')">
                            <span class="text-en">Sign Up</span>
                            <span class="text-sw" style="display:none;">Jisajili</span>
                        </a>
                    </p>
                </div>
            </div>
        </div>

        <div id="dashboardPage" class="page">
            <div class="container">
                <div class="dashboard-header">
                    <h1>
                        <span class="text-en">My Dashboard</span>
                        <span class="text-sw" style="display:none;">Dashibodi Yangu</span>
                    </h1>
                    <div id="premiumBadge"></div>
                </div>
                
                <div class="stats-grid" id="statsGrid">
                </div>

                <div class="dashboard-section">
                    <h2>
                        <span class="text-en">Recent Progress</span>
                        <span class="text-sw" style="display:none;">Maendeleo ya Hivi Karibuni</span>
                    </h2>
                    <div id="recentProgress"></div>
                </div>

                <div class="dashboard-section">
                    <h2>
                        <span class="text-en">Recent Quiz Results</span>
                        <span class="text-sw" style="display:none;">Matokeo ya Majaribio ya Hivi Karibuni</span>
                    </h2>
                    <div id="recentQuizzes"></div>
                </div>
            </div>
        </div>

        <div id="coursesPage" class="page">
            <div class="container">
                <div class="page-header">
                    <h1>
                        <span class="text-en">ğŸ“š Available Courses</span>
                        <span class="text-sw" style="display:none;">ğŸ“š Kozi Zinazopatikana</span>
                    </h1>
                    <div class="search-box">
                        <span class="search-icon">ğŸ”</span>
                        <input type="text" id="courseSearch" class="search-input" placeholder="Search courses..." oninput="searchCourses(this.value)">
                    </div>
                </div>
                
                <div class="filter-bar">
                    <button class="filter-btn active" onclick="filterCourses('all')">
                        <span class="filter-icon">ğŸ“‹</span>
                        <span class="text-en">All</span>
                        <span class="text-sw" style="display:none;">Zote</span>
                    </button>
                    <button class="filter-btn" onclick="filterCourses('math')">
                        <span class="filter-icon">ğŸ“</span>
                        <span class="text-en">Math</span>
                        <span class="text-sw" style="display:none;">Hesabu</span>
                    </button>
                    <button class="filter-btn" onclick="filterCourses('business')">
                        <span class="filter-icon">ğŸ’¼</span>
                        <span class="text-en">Business</span>
                        <span class="text-sw" style="display:none;">Biashara</span>
                    </button>
                    <button class="filter-btn" onclick="filterCourses('vocational')">
                        <span class="filter-icon">ğŸ”§</span>
                        <span class="text-en">Vocational</span>
                        <span class="text-sw" style="display:none;">Ufundi</span>
                    </button>
                </div>

                <div class="courses-grid" id="coursesGrid"></div>
                
                <div class="no-results" id="noResults" style="display:none;">
                    <div class="no-results-icon">ğŸ”</div>
                    <h3 class="text-en">No courses found</h3>
                    <h3 class="text-sw" style="display:none;">Hakuna kozi zilizopatikana</h3>
                    <p class="text-en">Try adjusting your search or filters</p>
                    <p class="text-sw" style="display:none;">Jaribu kubadilisha utafutaji wako</p>
                </div>
            </div>
        </div>

        <div id="courseDetailPage" class="page">
            <div class="container">
                <button class="btn btn-outline" onclick="showPage('courses')">
                    <span class="text-en">â† Back to Courses</span>
                    <span class="text-sw" style="display:none;">â† Rudi kwa Kozi</span>
                </button>
                <div id="courseDetail"></div>
            </div>
        </div>

        <div id="lessonPage" class="page">
            <div class="container">
                <div class="lesson-header">
                    <button class="btn btn-outline" onclick="backToCourse()">
                        <span class="text-en">â† Back to Course</span>
                        <span class="text-sw" style="display:none;">â† Rudi kwa Kozi</span>
                    </button>
                    <div class="lesson-actions">
                        <button class="btn btn-sm btn-outline" onclick="toggleBookmark()" id="bookmarkBtn" title="Bookmark lesson">
                            <span id="bookmarkIcon">ğŸ”–</span>
                        </button>
                        <button class="btn btn-sm btn-outline" onclick="toggleNotes()" id="notesBtn" title="Take notes">
                            <span>ğŸ“</span>
                        </button>
                        <button class="btn btn-sm btn-outline" onclick="shareLesson()" title="Share lesson">
                            <span>ğŸ“¤</span>
                        </button>
                    </div>
                </div>
                <div id="lessonContent"></div>
                
                <!-- Notes Panel -->
                <div class="notes-panel" id="notesPanel" style="display:none;">
                    <div class="notes-header">
                        <h3>
                            <span class="text-en">ğŸ“ Lesson Notes</span>
                            <span class="text-sw" style="display:none;">ğŸ“ Maelezo ya Somo</span>
                        </h3>
                        <button class="btn btn-sm btn-outline" onclick="toggleNotes()">Ã—</button>
                    </div>
                    <div class="notes-content">
                        <textarea id="notesTextarea" placeholder="Type your notes here..." rows="8"></textarea>
                        <div class="notes-actions">
                            <button class="btn btn-primary" onclick="saveNotes()">
                                <span class="text-en">Save Notes</span>
                                <span class="text-sw" style="display:none;">Hifadhi Maelezo</span>
                            </button>
                            <span class="notes-saved" id="notesSaved" style="display:none;">
                                <span class="text-en">âœ“ Saved</span>
                                <span class="text-sw" style="display:none;">âœ… Imehifadhiwa</span>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="quizPage" class="page">
            <div class="container">
                <button class="btn btn-outline" onclick="backToCourse()">
                    <span class="text-en">â† Back to Course</span>
                    <span class="text-sw" style="display:none;">â† Rudi kwa Kozi</span>
                </button>
                <div id="quizContent"></div>
            </div>
        </div>

        <div id="chatbotPage" class="page">
            <div class="container">
                <div class="chatbot-container">
                    <div class="chatbot-header">
                        <div class="chatbot-avatar">ğŸ¤–</div>
                        <div class="chatbot-info">
                            <h2>
                                <span class="text-en">AI Tutor</span>
                                <span class="text-sw" style="display:none;">Mwalimu wa AI</span>
                            </h2>
                            <span class="chatbot-status">
                                <span class="status-dot online"></span>
                                <span class="text-en">Online - Ready to help</span>
                                <span class="text-sw" style="display:none;">Mtandaoni - Tayari kusaidia</span>
                            </span>
                        </div>
                        <button class="btn btn-sm btn-outline" onclick="clearChat()" title="Clear chat">ğŸ—‘ï¸</button>
                    </div>
                    
                    <div class="chat-messages" id="chatMessages">
                        <div class="chat-welcome">
                            <div class="welcome-icon">ğŸ‘‹</div>
                            <h3 class="text-en">Hello! I'm your AI Tutor</h3>
                            <h3 class="text-sw" style="display:none;">Habari! Mimi ni Mwalimu wako wa AI</h3>
                            <p class="text-en">Ask me anything about Math, Business, or Vocational Skills!</p>
                            <p class="text-sw" style="display:none;">Niulize chochote kuhusu Hesabu, Biashara, au Ujuzi wa Ufundi!</p>
                        </div>
                    </div>
                    
                    <div class="typing-indicator" id="typingIndicator" style="display:none;">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <span class="text-en">AI is thinking...</span>
                        <span class="text-sw" style="display:none;">AI inafikiria...</span>
                    </div>
                    
                    <div class="suggested-questions" id="suggestedQuestions">
                        <span class="suggested-label text-en">Try asking:</span>
                        <span class="suggested-label text-sw" style="display:none;">Jaribu kuuliza:</span>
                        <button class="suggested-btn" onclick="askSuggested('How do I solve quadratic equations?')">ğŸ“ Quadratic equations</button>
                        <button class="suggested-btn" onclick="askSuggested('Explain basic accounting')">ğŸ’° Basic accounting</button>
                        <button class="suggested-btn" onclick="askSuggested('What are marketing strategies?')">ğŸ“ˆ Marketing tips</button>
                    </div>
                    
                    <form class="chat-input-form" onsubmit="sendMessage(event)">
                        <div class="chat-input-wrapper">
                            <input type="text" id="chatInput" class="chat-input" placeholder="Type your question..." required autocomplete="off">
                            <button type="button" class="voice-btn" onclick="startVoiceInput()" title="Voice input">ğŸ¤</button>
                        </div>
                        <button type="submit" class="btn btn-primary send-btn" id="sendBtn">
                            <span class="send-icon">â¤</span>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div id="notification" class="notification"></div>

    <!-- Gamification Section -->
    <div id="gamificationPage" class="page">
        <div class="container">
            <h1 class="page-title">
                <span class="text-en">ğŸ† Achievements & Leaderboard</span>
                <span class="text-sw" style="display:none;">ğŸ† Mafanikio na Orodha ya Viongozi</span>
            </h1>
            
            <div class="gamification-stats" id="gamificationStats">
                <div class="stat-card">
                    <div class="stat-icon">â­</div>
                    <div class="stat-value" id="totalPoints">0</div>
                    <div class="stat-label">
                        <span class="text-en">Total Points</span>
                        <span class="text-sw" style="display:none;">Pointi Zote</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ”¥</div>
                    <div class="stat-value" id="currentStreak">0</div>
                    <div class="stat-label">
                        <span class="text-en">Day Streak</span>
                        <span class="text-sw" style="display:none;">Siku Mfululizo</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“Š</div>
                    <div class="stat-value" id="userLevel">1</div>
                    <div class="stat-label">
                        <span class="text-en">Level</span>
                        <span class="text-sw" style="display:none;">Kiwango</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ…</div>
                    <div class="stat-value" id="badgeCount">0</div>
                    <div class="stat-label">
                        <span class="text-en">Badges</span>
                        <span class="text-sw" style="display:none;">Beji</span>
                    </div>
                </div>
            </div>

            <div class="badges-section">
                <h2>
                    <span class="text-en">ğŸ–ï¸ Your Badges</span>
                    <span class="text-sw" style="display:none;">ğŸ–ï¸ Beji Zako</span>
                </h2>
                <div class="badges-grid" id="badgesGrid"></div>
            </div>

            <div class="leaderboard-section">
                <h2>
                    <span class="text-en">ğŸ† Leaderboard</span>
                    <span class="text-sw" style="display:none;">ğŸ† Orodha ya Viongozi</span>
                </h2>
                <div class="leaderboard-filters">
                    <button class="filter-btn active" onclick="loadLeaderboard('all')">
                        <span class="text-en">All Time</span>
                        <span class="text-sw" style="display:none;">Wakati Wote</span>
                    </button>
                    <button class="filter-btn" onclick="loadLeaderboard('week')">
                        <span class="text-en">This Week</span>
                        <span class="text-sw" style="display:none;">Wiki Hii</span>
                    </button>
                    <button class="filter-btn" onclick="loadLeaderboard('month')">
                        <span class="text-en">This Month</span>
                        <span class="text-sw" style="display:none;">Mwezi Huu</span>
                    </button>
                </div>
                <div class="leaderboard-list" id="leaderboardList"></div>
            </div>
        </div>
    </div>

    <!-- Certificates Section -->
    <div id="certificatesPage" class="page">
        <div class="container">
            <h1 class="page-title">
                <span class="text-en">ğŸ“œ My Certificates</span>
                <span class="text-sw" style="display:none;">ğŸ“œ Vyeti Vyangu</span>
            </h1>
            <div class="certificates-grid" id="certificatesGrid"></div>
        </div>
    </div>

    <!-- User Profile Page -->
    <div id="profilePage" class="page">
        <div class="container">
            <div class="profile-header">
                <div class="profile-avatar-section">
                    <div class="profile-avatar" id="profileAvatar">
                        <span id="avatarInitial">U</span>
                        <img id="avatarImage" src="" alt="" style="display:none;">
                    </div>
                    <label class="avatar-upload-btn" for="avatarUpload">
                        <span>ğŸ“·</span>
                        <input type="file" id="avatarUpload" accept="image/*" onchange="uploadAvatar(event)" style="display:none;">
                    </label>
                </div>
                <div class="profile-info">
                    <h1 id="profileUsername">Username</h1>
                    <p id="profileEmail" class="text-muted">email@example.com</p>
                    <div class="profile-badges" id="profileBadges"></div>
                </div>
            </div>
            
            <div class="profile-stats-grid">
                <div class="profile-stat-card">
                    <div class="stat-icon">ğŸ”¥</div>
                    <div class="stat-value" id="profileStreak">0</div>
                    <div class="stat-label">Day Streak</div>
                </div>
                <div class="profile-stat-card">
                    <div class="stat-icon">â­</div>
                    <div class="stat-value" id="profilePoints">0</div>
                    <div class="stat-label">Total Points</div>
                </div>
                <div class="profile-stat-card">
                    <div class="stat-icon">ğŸ“š</div>
                    <div class="stat-value" id="profileCourses">0</div>
                    <div class="stat-label">Courses</div>
                </div>
                <div class="profile-stat-card">
                    <div class="stat-icon">ğŸ†</div>
                    <div class="stat-value" id="profileRank">#-</div>
                    <div class="stat-label">Rank</div>
                </div>
            </div>
            
            <!-- Progress Chart -->
            <div class="profile-section">
                <h2>ğŸ“Š Learning Progress</h2>
                <div class="chart-container">
                    <canvas id="progressChart"></canvas>
                </div>
            </div>
            
            <!-- Activity Chart -->
            <div class="profile-section">
                <h2>ğŸ“ˆ Weekly Activity</h2>
                <div class="chart-container">
                    <canvas id="activityChart"></canvas>
                </div>
            </div>
            
            <!-- Bookmarked Lessons -->
            <div class="profile-section">
                <h2>ğŸ”– Bookmarked Lessons</h2>
                <div class="bookmarks-grid" id="bookmarksGrid">
                    <div class="no-bookmarks">
                        <p>No bookmarked lessons yet</p>
                    </div>
                </div>
            </div>
            
            <!-- Recent Notes -->
            <div class="profile-section">
                <h2>ğŸ“ Recent Notes</h2>
                <div class="notes-list" id="notesList">
                    <div class="no-notes">
                        <p>No notes yet</p>
                    </div>
                </div>
            </div>
            
            <!-- Settings -->
            <div class="profile-section">
                <h2>âš™ï¸ Settings</h2>
                <div class="settings-grid">
                    <div class="setting-item">
                        <span>ğŸ”” Push Notifications</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="pushToggle" onchange="togglePushNotifications()">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <span>ğŸ”” Browser Notifications</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="notificationsToggle" checked onchange="toggleBrowserNotifications()">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <span>ğŸ”Š Sound Effects</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="soundToggle" checked onchange="toggleSound()">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <span>ğŸŒ Language</span>
                        <select id="languageSelect" onchange="changeLanguage(this.value)">
                            <option value="en">English</option>
                            <option value="sw">Kiswahili</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Onboarding Tour Modal -->
    <div id="onboardingTour" class="onboarding-overlay" style="display:none;">
        <div class="onboarding-modal">
            <div class="onboarding-progress">
                <div class="onboarding-progress-bar" id="onboardingProgress"></div>
            </div>
            <div class="onboarding-content" id="onboardingContent">
                <!-- Step content injected by JS -->
            </div>
            <div class="onboarding-nav">
                <button class="btn btn-outline" id="onboardingPrev" onclick="prevOnboardingStep()">
                    <span class="text-en">Previous</span>
                    <span class="text-sw" style="display:none;">Iliyotangulia</span>
                </button>
                <div class="onboarding-dots" id="onboardingDots"></div>
                <button class="btn btn-primary" id="onboardingNext" onclick="nextOnboardingStep()">
                    <span class="text-en">Next</span>
                    <span class="text-sw" style="display:none;">Ifuatayo</span>
                </button>
            </div>
            <button class="onboarding-skip" onclick="skipOnboarding()">
                <span class="text-en">Skip Tour</span>
                <span class="text-sw" style="display:none;">Ruka Ziara</span>
            </button>
        </div>
    </div>

    <!-- Level Up Modal -->
    <div id="levelUpModal" class="celebration-modal" style="display:none;">
        <div class="celebration-content">
            <div class="celebration-icon animate-bounce">ğŸ‰</div>
            <h2 class="celebration-title">Level Up!</h2>
            <div class="level-display">
                <span class="old-level" id="oldLevel">1</span>
                <span class="level-arrow">â†’</span>
                <span class="new-level" id="newLevel">2</span>
            </div>
            <p class="celebration-message" id="levelUpMessage">You've reached a new level!</p>
            <button class="btn btn-primary" onclick="closeLevelUpModal()">Awesome! ğŸš€</button>
        </div>
    </div>

    <!-- Badge Earned Modal -->
    <div id="badgeModal" class="celebration-modal" style="display:none;">
        <div class="celebration-content">
            <div class="badge-earned-icon" id="earnedBadgeIcon">ğŸ…</div>
            <h2 class="celebration-title">Badge Earned!</h2>
            <p class="badge-earned-name" id="earnedBadgeName">Achievement Unlocked</p>
            <p class="celebration-message" id="badgeMessage">Keep up the great work!</p>
            <button class="btn btn-primary" onclick="closeBadgeModal()">Collect Badge âœ¨</button>
        </div>
    </div>

    <!-- Streak Modal -->
    <div id="streakModal" class="celebration-modal" style="display:none;">
        <div class="celebration-content">
            <div class="streak-fire">ğŸ”¥</div>
            <h2 class="celebration-title" id="streakTitle">7 Day Streak!</h2>
            <p class="celebration-message">You're on fire! Keep learning every day!</p>
            <div class="streak-bonus">+<span id="streakBonus">50</span> bonus points!</div>
            <button class="btn btn-primary" onclick="closeStreakModal()">Keep Going! ğŸ’ª</button>
        </div>
    </div>

    <!-- Keyboard Shortcuts Modal -->
    <div id="shortcutsModal" class="modal" style="display:none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>âŒ¨ï¸ Keyboard Shortcuts</h2>
                <button class="modal-close" onclick="closeShortcutsModal()">Ã—</button>
            </div>
            <div class="shortcuts-grid">
                <div class="shortcut-item"><kbd>H</kbd> <span>Home</span></div>
                <div class="shortcut-item"><kbd>C</kbd> <span>Courses</span></div>
                <div class="shortcut-item"><kbd>D</kbd> <span>Dashboard</span></div>
                <div class="shortcut-item"><kbd>T</kbd> <span>AI Tutor</span></div>
                <div class="shortcut-item"><kbd>R</kbd> <span>Rewards</span></div>
                <div class="shortcut-item"><kbd>P</kbd> <span>Profile</span></div>
                <div class="shortcut-item"><kbd>L</kbd> <span>Toggle Language</span></div>
                <div class="shortcut-item"><kbd>M</kbd> <span>Toggle Dark Mode</span></div>
                <div class="shortcut-item"><kbd>?</kbd> <span>Show Shortcuts</span></div>
                <div class="shortcut-item"><kbd>Esc</kbd> <span>Close Modal</span></div>
            </div>
        </div>
    </div>

    <!-- Share Modal -->
    <div id="shareModal" class="modal" style="display:none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ“¤ Share</h2>
                <button class="modal-close" onclick="closeShareModal()">Ã—</button>
            </div>
            <div class="share-content">
                <div class="share-item" onclick="shareOnWhatsApp()">
                    <span class="share-icon">ğŸ’¬</span>
                    <span>WhatsApp</span>
                </div>
                <div class="share-item" onclick="shareOnTwitter()">
                    <span class="share-icon">ğŸ¦</span>
                    <span>Twitter</span>
                </div>
                <div class="share-item" onclick="shareOnFacebook()">
                    <span class="share-icon">ğŸ“˜</span>
                    <span>Facebook</span>
                </div>
                <div class="share-item" onclick="copyShareLink()">
                    <span class="share-icon">ğŸ”—</span>
                    <span>Copy Link</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Action Button -->
    <div class="fab-container" id="fabContainer">
        <div class="fab-menu">
            <div class="fab-item" onclick="showPage('chatbot'); toggleFab();">
                <span class="fab-item-icon">ğŸ¤–</span>
                <span class="text-en">AI Tutor</span>
                <span class="text-sw" style="display:none;">Mwalimu AI</span>
            </div>
            <div class="fab-item" onclick="showPage('courses'); toggleFab();">
                <span class="fab-item-icon">ğŸ“š</span>
                <span class="text-en">Courses</span>
                <span class="text-sw" style="display:none;">Kozi</span>
            </div>
            <div class="fab-item" onclick="showPage('gamification'); toggleFab();">
                <span class="fab-item-icon">ğŸ†</span>
                <span class="text-en">Rewards</span>
                <span class="text-sw" style="display:none;">Tuzo</span>
            </div>
            <div class="fab-item" onclick="showPage('profile'); toggleFab();">
                <span class="fab-item-icon">ğŸ‘¤</span>
                <span class="text-en">Profile</span>
                <span class="text-sw" style="display:none;">Wasifu</span>
            </div>
            <div class="fab-item" onclick="showShortcutsModal(); toggleFab();">
                <span class="fab-item-icon">âŒ¨ï¸</span>
                <span class="text-en">Shortcuts</span>
                <span class="text-sw" style="display:none;">Njia za mkato</span>
            </div>
        </div>
        <button class="fab" onclick="toggleFab()" id="fabBtn">
            <span id="fabIcon">+</span>
        </button>
    </div>

    <!-- PWA Install Prompt -->
    <div id="installPrompt" class="install-prompt" style="display:none;">
        <div class="install-content">
            <span class="install-icon">ğŸ“±</span>
            <div class="install-text">
                <strong>Install ElimuAI</strong>
                <span class="text-en">Add to home screen for offline access</span>
                <span class="text-sw" style="display:none;">Ongeza kwenye skrini ya nyumbani</span>
            </div>
            <button class="btn btn-primary btn-sm" id="installBtn">Install</button>
            <button class="btn-close" onclick="dismissInstallPrompt()">Ã—</button>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        // Register Service Worker for PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(reg => console.log('ElimuAI: Service Worker registered'))
                    .catch(err => console.log('ElimuAI: SW registration failed', err));
            });
        }

        // PWA Install Prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            document.getElementById('installPrompt').style.display = 'flex';
        });

        document.getElementById('installBtn')?.addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                deferredPrompt = null;
                document.getElementById('installPrompt').style.display = 'none';
            }
        });

        function dismissInstallPrompt() {
            document.getElementById('installPrompt').style.display = 'none';
        }
    </script>
</body>
</html>
